diff --git a/contrib/test_disk-server/change_parameters.cpp b/contrib/test_disk-server/change_parameters.cpp
index 3cefe8a805..48463c99af 100644
--- a/contrib/test_disk-server/change_parameters.cpp
+++ b/contrib/test_disk-server/change_parameters.cpp
@@ -4,11 +4,26 @@
 
 int main() {
     uint32_t read_latency_ms, write_latency_ms;
+    ErrorCode error_code;
 
-    std::cout << "Read latency: ";
+    std::cout << "Read latency (ms): ";
     std::cin >> read_latency_ms;
-    std::cout << "Write latency: ";
+    std::cout << "Write latency (ms): ";
     std::cin >> write_latency_ms;
 
-    change_server_parameters("127.0.0.1", 31234, read_latency_ms, write_latency_ms);
+    int t;
+
+    std::cout << "Sense key (in hex): ";
+    std::cin >> std::hex >> t;
+    error_code.key = static_cast<uint8_t>(t);
+
+    std::cout << "ASC (in hex): ";
+    std::cin >> std::hex >> t;
+    error_code.asc = static_cast<uint8_t>(t);
+
+    std::cout << "ASCQ (in hex): ";
+    std::cin >> std::hex >> t;
+    error_code.ascq = static_cast<uint8_t>(t);
+
+    change_server_parameters("127.0.0.1", 31234, read_latency_ms, write_latency_ms, error_code);
 }
\ No newline at end of file
diff --git a/contrib/test_disk-server/change_parameters.py b/contrib/test_disk-server/change_parameters.py
index 57e4256266..0f34e07ea8 100644
--- a/contrib/test_disk-server/change_parameters.py
+++ b/contrib/test_disk-server/change_parameters.py
@@ -1,7 +1,13 @@
 import server_toolkit_py as st
 
 if __name__ == "__main__":
-    read_latency_ms = int(input("Read latency: "))
-    write_latency_ms = int(input("Write latency: "))
+    read_latency_ms = int(input("Read latency (ms): "))
+    write_latency_ms = int(input("Write latency (ms): "))
 
-    st.change_server_parameters("127.0.0.1", 31234, read_latency_ms, write_latency_ms)
\ No newline at end of file
+    error_code = st.ErrorCode()
+
+    error_code.key = int(input("Sense key (in hex): "), 16)
+    error_code.asc = int(input("ASC (in hex): "), 16)
+    error_code.ascq = int(input("ASCQ (in hex): "), 16)
+
+    st.change_server_parameters("127.0.0.1", 31234, read_latency_ms, write_latency_ms, error_code)
diff --git a/contrib/test_disk-server/server.cpp b/contrib/test_disk-server/server.cpp
index 3f703bd4f0..e61ead5aa4 100644
--- a/contrib/test_disk-server/server.cpp
+++ b/contrib/test_disk-server/server.cpp
@@ -11,8 +11,12 @@ int main() {
         return -1;
     }
 
-    std::atomic<uint32_t> read_latency_ms = 34;
-    std::atomic<uint32_t> write_latency_ms = 7;
+    std::atomic<uint32_t> read_latency_ms = 0;
+    std::atomic<uint32_t> write_latency_ms = 0;
+
+    std::atomic<uint8_t> sense_key = 0;
+    std::atomic<uint8_t> asc = 0;
+    std::atomic<uint8_t> ascq = 0;
 
     run_server(server_fd, [&](const ServerRequest& server_req) {
         ServerResponse server_res{};
@@ -21,6 +25,11 @@ int main() {
             case SOURCE_CHANGE_PARAMETERS:
                 read_latency_ms = server_req.change_parameters_payload.read_latency_ms;
                 write_latency_ms = server_req.change_parameters_payload.write_latency_ms;
+
+                sense_key = server_req.change_parameters_payload.error_code.key;
+                asc = server_req.change_parameters_payload.error_code.asc;
+                ascq = server_req.change_parameters_payload.error_code.ascq;
+
                 break;
             case SOURCE_TEST_DISK:
                 std::cout << std::format("Command: 0x{:02x}", server_req.test_disk_payload.command) << std::endl;
@@ -29,6 +38,11 @@ int main() {
                     server_req.test_disk_payload.command == 0x28 || server_req.test_disk_payload.command == 0x08
                     ? read_latency_ms
                     : write_latency_ms;
+
+                server_res.error_code.key = sense_key;
+                server_res.error_code.asc = asc;
+                server_res.error_code.ascq = ascq;
+
                 break;
         }
 
diff --git a/contrib/test_disk-server/server.py b/contrib/test_disk-server/server.py
index 55997c1fc2..7e7ea48e3f 100644
--- a/contrib/test_disk-server/server.py
+++ b/contrib/test_disk-server/server.py
@@ -3,8 +3,12 @@
 read_latency_ms = 0
 write_latency_ms = 0
 
+sense_key = 0
+asc = 0
+ascq = 0
+
 def callback(server_req: st.ServerRequest) -> st.ServerResponse:
-    global read_latency_ms, write_latency_ms
+    global read_latency_ms, write_latency_ms, sense_key, asc, ascq
 
     server_res = st.ServerResponse()
 
@@ -12,6 +16,10 @@ def callback(server_req: st.ServerRequest) -> st.ServerResponse:
         read_latency_ms = server_req.change_parameters_payload.read_latency_ms
         write_latency_ms = server_req.change_parameters_payload.write_latency_ms
 
+        sense_key = server_req.change_parameters_payload.error_code.key
+        asc = server_req.change_parameters_payload.error_code.asc
+        ascq = server_req.change_parameters_payload.error_code.ascq
+
     elif server_req.source == st.SOURCE_TEST_DISK:
         print(f"Command: 0x{server_req.test_disk_payload.command:02X}")
 
@@ -19,6 +27,10 @@ def callback(server_req: st.ServerRequest) -> st.ServerResponse:
             if server_req.test_disk_payload.command == 0x28 or server_req.test_disk_payload.command == 0x08 \
             else write_latency_ms
 
+        server_res.error_code.key = sense_key
+        server_res.error_code.asc = asc
+        server_res.error_code.ascq = ascq
+
     return server_res
 
 if __name__ == "__main__":
diff --git a/contrib/test_disk-server/server_toolkit/bindings.cpp b/contrib/test_disk-server/server_toolkit/bindings.cpp
index 29e04abc59..0d49cb6bd8 100644
--- a/contrib/test_disk-server/server_toolkit/bindings.cpp
+++ b/contrib/test_disk-server/server_toolkit/bindings.cpp
@@ -21,10 +21,17 @@ PYBIND11_MODULE(server_toolkit_py, m) {
             .def_readwrite("sector", &TestDiskPayload::sector)
             .def_readwrite("req_target_len", &TestDiskPayload::req_target_len);
 
+    py::class_<ErrorCode>(m, "ErrorCode")
+            .def(py::init<>())
+            .def_readwrite("key", &ErrorCode::key)
+            .def_readwrite("asc", &ErrorCode::asc)
+            .def_readwrite("ascq", &ErrorCode::ascq);
+
     py::class_<ChangeParametersPayload>(m, "ChangeParametersPayload")
             .def(py::init<>())
             .def_readwrite("read_latency_ms", &ChangeParametersPayload::read_latency_ms)
-            .def_readwrite("write_latency_ms", &ChangeParametersPayload::write_latency_ms);
+            .def_readwrite("write_latency_ms", &ChangeParametersPayload::write_latency_ms)
+            .def_readwrite("error_code", &ChangeParametersPayload::error_code);
 
     py::class_<ServerRequest>(m, "ServerRequest")
             .def(py::init<>())
@@ -41,5 +48,5 @@ PYBIND11_MODULE(server_toolkit_py, m) {
     // Functions
     m.def("create_server", &create_server, "ip"_a, "port"_a);
     m.def("run_server", &run_server, "server_fd"_a, "callback"_a, py::call_guard<py::gil_scoped_release>());
-    m.def("change_server_parameters", &change_server_parameters, "ip"_a, "port"_a, "read_latency_ms"_a, "write_latency_ms"_a);
+    m.def("change_server_parameters", &change_server_parameters, "ip"_a, "port"_a, "read_latency_ms"_a, "write_latency_ms"_a, "error_code"_a);
 }
diff --git a/contrib/test_disk-server/server_toolkit/server_toolkit.cpp b/contrib/test_disk-server/server_toolkit/server_toolkit.cpp
index 74e2822631..b83457a337 100644
--- a/contrib/test_disk-server/server_toolkit/server_toolkit.cpp
+++ b/contrib/test_disk-server/server_toolkit/server_toolkit.cpp
@@ -96,7 +96,9 @@ void _client_routine(int client_fd, const Callback& callback) {
         if (send(client_fd, &server_res, sizeof(server_res), 0) == -1) {
             std::cerr << "Unable to send response to client socket: " << strerror(errno) << std::endl;
         } else {
-            std::cout << "Sent: latency = " << server_res.latency << std::endl;
+            std::cout << "Sent: latency = " << server_res.latency
+            << ", error code = " << std::format("(0x{:02x}|0x{:02x}|0x{:02x})", server_res.error_code.key, server_res.error_code.asc, server_res.error_code.ascq)
+            << std::endl;
         }
     }
 
@@ -107,7 +109,7 @@ void _client_routine(int client_fd, const Callback& callback) {
 
 // ============================================================================
 
-int change_server_parameters(const std::string& ip, uint16_t port, uint32_t read_latency_ms, uint32_t write_latency_ms) {
+int change_server_parameters(const std::string& ip, uint16_t port, uint32_t read_latency_ms, uint32_t write_latency_ms, ErrorCode error_code) {
     // server address
     sockaddr_in addr = {
         .sin_family = AF_INET,
@@ -139,13 +141,17 @@ int change_server_parameters(const std::string& ip, uint16_t port, uint32_t read
         .change_parameters_payload = {
             .read_latency_ms = read_latency_ms,
             .write_latency_ms = write_latency_ms,
+            .error_code = error_code
         }
     };
 
     if (send(fd, &server_req, sizeof(server_req), 0) == -1) {
         std::cerr << "Unable to send request to client socket: " << strerror(errno) << std::endl;
     } else {
-        std::cout << "Sent: read_latency_ms = " << read_latency_ms << ", write_latency_ms = " << write_latency_ms << std::endl;
+        std::cout << "Sent: read_latency_ms = " << read_latency_ms
+        << ", write_latency_ms = " << write_latency_ms
+        << ", error code = " << std::format("(0x{:02x}|0x{:02x}|0x{:02x})", server_req.change_parameters_payload.error_code.key, server_req.change_parameters_payload.error_code.asc, server_req.change_parameters_payload.error_code.ascq)
+        << std::endl;
     }
 
     close(fd);
diff --git a/contrib/test_disk-server/server_toolkit/server_toolkit.h b/contrib/test_disk-server/server_toolkit/server_toolkit.h
index 04f9cf6952..87010f6d27 100644
--- a/contrib/test_disk-server/server_toolkit/server_toolkit.h
+++ b/contrib/test_disk-server/server_toolkit/server_toolkit.h
@@ -15,6 +15,6 @@ int run_server(int server_fd, const Callback& callback);
 
 void _client_routine(int client_fd, const Callback& callback);
 
-int change_server_parameters(const std::string& ip, uint16_t port, uint32_t read_latency_ms, uint32_t write_latency_ms);
+int change_server_parameters(const std::string& ip, uint16_t port, uint32_t read_latency_ms, uint32_t write_latency_ms, ErrorCode error_code);
 
 #endif //SERVER_H
diff --git a/contrib/test_disk-server/structs.h b/contrib/test_disk-server/structs.h
index 14b180cc18..c94905d678 100644
--- a/contrib/test_disk-server/structs.h
+++ b/contrib/test_disk-server/structs.h
@@ -4,6 +4,12 @@
 #define SOURCE_TEST_DISK 1
 #define SOURCE_CHANGE_PARAMETERS 2
 
+typedef struct ErrorCode {
+    uint8_t key;
+    uint8_t asc;
+    uint8_t ascq;
+} ErrorCode;
+
 typedef struct TestDiskPayload {
     uint8_t disk_id;
     uint8_t command;
@@ -14,6 +20,8 @@ typedef struct TestDiskPayload {
 typedef struct ChangeParametersPayload {
     uint32_t read_latency_ms;
     uint32_t write_latency_ms;
+
+    ErrorCode error_code;
 } ChangeParametersPayload;
 
 typedef struct ServerRequest {
@@ -23,7 +31,7 @@ typedef struct ServerRequest {
 } ServerRequest;
 
 typedef struct ServerResponse {
-    uint8_t error_code;
+    ErrorCode error_code;
     uint32_t latency;
 } ServerResponse;
 
diff --git a/hw/scsi/test_disk.c b/hw/scsi/test_disk.c
index dfb1d5b5d3..92d731683a 100644
--- a/hw/scsi/test_disk.c
+++ b/hw/scsi/test_disk.c
@@ -6,6 +6,7 @@
 #include "qapi/error.h"
 #include "scsi/constants.h"
 #include "contrib/test_disk-server/structs.h"
+#include "qapi/qapi-types-common.h"
 #include "sysemu/block-backend.h"
 #include "sysemu/cpu-timers.h"
 #include "sysemu/runstate.h"
@@ -31,6 +32,8 @@ typedef struct TestDiskReq {
 
     struct iovec iov;
     QEMUIOVector qiov;
+
+    SCSISense current_error_code;
 } TestDiskReq;
 
 
@@ -395,6 +398,10 @@ static void test_disk_bh_routine(void* opaque) {
 
     disk_req->response_buf_len = args->req_target_len;
 
+    disk_req->current_error_code.key = server_res.error_code.key;
+    disk_req->current_error_code.asc = server_res.error_code.asc;
+    disk_req->current_error_code.ascq = server_res.error_code.ascq;
+
     timer_mod(disk_req->timer, qemu_clock_get_ms(QEMU_CLOCK_VIRTUAL) + latency_ms);
 
     scsi_req_unref(scsi_req);
@@ -405,6 +412,12 @@ static void test_disk_latency_callback(void* opaque) {
     TestDiskReq* disk_req = opaque;
     SCSIRequest* scsi_req = &disk_req->parent_scsi_req;
 
+    if ((disk_req->current_error_code.key | disk_req->current_error_code.asc | disk_req->current_error_code.ascq) != 0) {
+        scsi_req_build_sense(scsi_req, disk_req->current_error_code);
+        scsi_req_complete(scsi_req, CHECK_CONDITION);
+        return;
+    }
+
     TestDisk* disk = DO_UPCAST(TestDisk, parent_scsi_dev, disk_req->parent_scsi_req.dev);
     BlockBackend *blk = disk->parent_scsi_dev.conf.blk;
 
